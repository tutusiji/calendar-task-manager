# ä»»åŠ¡é¢œè‰²ä¸è¿›åº¦åŠŸèƒ½éƒ¨ç½²æŒ‡å—

**éƒ¨ç½²æ—¥æœŸ**: 2025-11-26  
**ç‰ˆæœ¬**: v1.2.0  
**åŠŸèƒ½**: ä»»åŠ¡é¢œè‰²è‡ªå®šä¹‰ã€è¿›åº¦è·Ÿè¸ªã€UI äº¤äº’ä¼˜åŒ–

---

## ğŸ“‹ æ›´æ–°å†…å®¹æ¦‚è§ˆ

### æ–°å¢åŠŸèƒ½

1. **ä»»åŠ¡é¢œè‰²è‡ªå®šä¹‰**

   - ä¸º"æ—¥å¸¸"ç±»å‹ä»»åŠ¡æä¾› 8 ç§é¢œè‰²é€‰æ‹©
   - é•‚ç©ºè¾¹æ¡†è®¾è®¡ï¼Œæµ…è‰²èƒŒæ™¯ + é¥±å’Œè‰²è¾¹æ¡†
   - é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶ï¼ˆColorPickerï¼‰

2. **ä»»åŠ¡è¿›åº¦è·Ÿè¸ª**

   - è¿›åº¦ç™¾åˆ†æ¯”è®¾ç½®ï¼ˆ0-100%ï¼‰
   - é¥¼å›¾æ ·å¼è¿›åº¦åœ†åœˆï¼ˆProgressCircleï¼‰
   - ä»»åŠ¡æ¡èƒŒæ™¯å¡«å……æ˜¾ç¤ºè¿›åº¦
   - Hover åŠ¨ç”»ï¼šé¥¼å›¾ â†” æ•°å­—ç™¾åˆ†æ¯”ï¼ˆ300msï¼‰

3. **UI ä¼˜åŒ–**
   - ç»Ÿä¸€å‘¨è§†å›¾ä½¿ç”¨ TaskBar ç»„ä»¶
   - ä»…"æ—¥å¸¸"ä»»åŠ¡æ˜¾ç¤ºé¢œè‰²å’Œè¿›åº¦åŠŸèƒ½
   - é‚€è¯·ç å¤åˆ¶åŠŸèƒ½å¢å¼ºï¼ˆæ”¯æŒ HTTP/IP åŸŸåï¼‰
   - ç»Ÿè®¡é¢æ¿åº•éƒ¨è¾¹è·ä¼˜åŒ–

### æ•°æ®åº“å˜æ›´

- **æ–°å¢å­—æ®µ**:
  - `Task.color` (TEXT, å¯é€‰) - ä»»åŠ¡é¢œè‰²
  - `Task.progress` (INTEGER, é»˜è®¤ 0) - ä»»åŠ¡è¿›åº¦ç™¾åˆ†æ¯”

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰

å¦‚æœå·²é…ç½® GitHub Actions è‡ªåŠ¨éƒ¨ç½²ï¼Œåªéœ€æ¨é€ä»£ç å³å¯ï¼š

```bash
# æœ¬åœ°æäº¤ä»£ç 
git add .
git commit -m "feat: add task color and progress features"
git push origin main

# GitHub Actions å°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
# 1. æ„å»º Docker é•œåƒ
# 2. æ¨é€åˆ° Docker Hub
# 3. SSH åˆ°æœåŠ¡å™¨
# 4. æ‹‰å–æœ€æ–°é•œåƒ
# 5. é‡å¯å®¹å™¨
# 6. è‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

#### æ­¥éª¤ 1: æœ¬åœ°æ„å»ºå¹¶æ¨é€é•œåƒ

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd d:\CodeLab\calendar-task-manager

# æ„å»ºå¹¶æ¨é€é•œåƒï¼ˆPowerShellï¼‰
.\build-and-push.ps1

# æˆ–ä½¿ç”¨ Bashï¼ˆLinux/Macï¼‰
./build-and-push.sh
```

#### æ­¥éª¤ 2: æœåŠ¡å™¨ç«¯æ›´æ–°

```bash
# SSH è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/calendar-task-manager

# æ‹‰å–æœ€æ–°é•œåƒ
docker-compose pull

# é‡å¯åº”ç”¨ï¼ˆä¼šè‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»ï¼‰
docker-compose up -d

# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
docker-compose logs -f app
```

---

## ğŸ—„ï¸ æ•°æ®åº“è¿ç§»è¯´æ˜

### é‡è¦æç¤º

> âš ï¸ **ä¸éœ€è¦é‡æ–°æ‰“åŒ…æ•°æ®åº“é•œåƒï¼**
>
> æ•°æ®åº“ä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„ PostgreSQL é•œåƒï¼ˆ`postgres:14-alpine`ï¼‰ï¼Œä¸åŒ…å«ä»»ä½•åº”ç”¨ç‰¹å®šçš„æ•°æ®ç»“æ„ã€‚
>
> æ•°æ®åº“ç»“æ„çš„å˜æ›´é€šè¿‡ **Prisma è¿ç§»æ–‡ä»¶** å®ç°ï¼Œè¿™äº›è¿ç§»ä¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚

### è¿ç§»æ–‡ä»¶

æœ¬æ¬¡æ›´æ–°åŒ…å«ä»¥ä¸‹è¿ç§»ï¼š

**æ–‡ä»¶**: `prisma/migrations/20251125165512_add_task_color_and_progress/migration.sql`

```sql
-- AlterTable
ALTER TABLE "Task" ADD COLUMN     "color" TEXT,
ADD COLUMN     "progress" INTEGER NOT NULL DEFAULT 0;
```

### è‡ªåŠ¨è¿ç§»æµç¨‹

åº”ç”¨å¯åŠ¨æ—¶ï¼ˆ`docker-compose up -d`ï¼‰ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œï¼š

1. **æ£€æŸ¥è¿ç§»çŠ¶æ€**

   ```bash
   npx prisma migrate status
   ```

2. **åº”ç”¨å¾…æ‰§è¡Œçš„è¿ç§»**

   ```bash
   npx prisma migrate deploy
   ```

3. **ç”Ÿæˆ Prisma Client**
   ```bash
   npx prisma generate
   ```

### æ‰‹åŠ¨éªŒè¯è¿ç§»

å¦‚éœ€æ‰‹åŠ¨éªŒè¯æ•°æ®åº“ç»“æ„ï¼š

```bash
# è¿›å…¥æ•°æ®åº“å®¹å™¨
docker exec -it calendar-postgres psql -U postgres -d calendar_tasks

# æŸ¥çœ‹ Task è¡¨ç»“æ„
\d "Task"

# åº”è¯¥çœ‹åˆ°æ–°å¢çš„å­—æ®µï¼š
# - color       | text                     |           |          |
# - progress    | integer                  |           | not null | 0

# é€€å‡º
\q
```

---

## âœ… éƒ¨ç½²éªŒè¯

### 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
cd /opt/calendar-task-manager
docker-compose ps

# åº”è¯¥çœ‹åˆ°æ‰€æœ‰å®¹å™¨éƒ½æ˜¯ "Up" çŠ¶æ€
```

### 2. æŸ¥çœ‹åº”ç”¨æ—¥å¿—

```bash
docker-compose logs -f app

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# âœ” Generated Prisma Client
# âœ” Migrations: 1 applied
# âœ¨ Ready on http://localhost:3000
```

### 3. éªŒè¯æ•°æ®åº“è¿ç§»

```bash
# æ£€æŸ¥è¿ç§»çŠ¶æ€
docker exec calendar-app npx prisma migrate status

# åº”è¯¥æ˜¾ç¤ºæ‰€æœ‰è¿ç§»éƒ½å·²åº”ç”¨
```

### 4. åŠŸèƒ½æµ‹è¯•

è®¿é—®åº”ç”¨å¹¶æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š

- [ ] åˆ›å»º"æ—¥å¸¸"ä»»åŠ¡æ—¶ï¼Œèƒ½çœ‹åˆ°é¢œè‰²é€‰æ‹©å™¨
- [ ] åˆ›å»º"æ—¥å¸¸"ä»»åŠ¡æ—¶ï¼Œèƒ½çœ‹åˆ°è¿›åº¦æ»‘å—
- [ ] ä»»åŠ¡æ¡æ˜¾ç¤ºé€‰å®šçš„é¢œè‰²ï¼ˆé•‚ç©ºè¾¹æ¡†æ ·å¼ï¼‰
- [ ] ä»»åŠ¡æ¡æ˜¾ç¤ºè¿›åº¦åœ†åœˆï¼ˆä»…æ—¥å¸¸ä»»åŠ¡ï¼‰
- [ ] Hover ä»»åŠ¡æ¡æ—¶ï¼Œè¿›åº¦åœ†åœˆåˆ‡æ¢ä¸ºæ•°å­—ç™¾åˆ†æ¯”
- [ ] ä»»åŠ¡æ¡èƒŒæ™¯å¡«å……åæ˜ è¿›åº¦ç™¾åˆ†æ¯”
- [ ] å‘¨è§†å›¾çš„ä»»åŠ¡æ¡æ ·å¼ä¸æ—¥å†è§†å›¾ä¸€è‡´
- [ ] é‚€è¯·ç å¤åˆ¶åŠŸèƒ½æ­£å¸¸ï¼ˆåŒ…æ‹¬ HTTP/IP åŸŸåï¼‰

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœéƒ¨ç½²åå‘ç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

### æ–¹å¼ä¸€ï¼šå›æ»šåˆ°ä¸Šä¸€ä¸ªé•œåƒç‰ˆæœ¬

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /opt/calendar-task-manager

# ä¿®æ”¹ docker-compose.ymlï¼ŒæŒ‡å®šä¸Šä¸€ä¸ªç‰ˆæœ¬
# image: tutusiji/calendar-task-manager:previous-tag

# é‡å¯å®¹å™¨
docker-compose up -d
```

### æ–¹å¼äºŒï¼šå›æ»šæ•°æ®åº“è¿ç§»

```bash
# æ³¨æ„ï¼šPrisma ä¸æ”¯æŒè‡ªåŠ¨å›æ»šï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ

# 1. è¿›å…¥æ•°æ®åº“
docker exec -it calendar-postgres psql -U postgres -d calendar_tasks

# 2. åˆ é™¤æ–°å¢å­—æ®µ
ALTER TABLE "Task" DROP COLUMN "color";
ALTER TABLE "Task" DROP COLUMN "progress";

# 3. åˆ é™¤è¿ç§»è®°å½•
DELETE FROM "_prisma_migrations"
WHERE migration_name = '20251125165512_add_task_color_and_progress';

# 4. é€€å‡º
\q

# 5. é‡å¯åº”ç”¨
docker-compose restart app
```

---

## ğŸ“Š æ€§èƒ½å½±å“è¯„ä¼°

### æ•°æ®åº“å½±å“

- **æ–°å¢å­—æ®µ**: 2 ä¸ªï¼ˆ`color`, `progress`ï¼‰
- **ç´¢å¼•å½±å“**: æ— ï¼ˆæœªæ·»åŠ æ–°ç´¢å¼•ï¼‰
- **æŸ¥è¯¢æ€§èƒ½**: æ— æ˜æ˜¾å½±å“
- **å­˜å‚¨å¢é•¿**: æ¯ä¸ªä»»åŠ¡çº¦å¢åŠ  10-20 å­—èŠ‚

### åº”ç”¨æ€§èƒ½

- **å‰ç«¯æ¸²æŸ“**: æ–°å¢åŠ¨ç”»ä½¿ç”¨ CSS transitionsï¼Œæ€§èƒ½å½±å“æå°
- **API å“åº”**: æ— å˜åŒ–ï¼ˆå­—æ®µä¸ºå¯é€‰ï¼‰
- **å†…å­˜å ç”¨**: æ— æ˜æ˜¾å¢åŠ 

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: è¿ç§»å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker-compose logs app

# æ‰‹åŠ¨è¿è¡Œè¿ç§»
docker exec calendar-app npx prisma migrate deploy

# å¦‚æœä»å¤±è´¥ï¼Œæ£€æŸ¥æ•°æ®åº“è¿æ¥
docker exec calendar-app npx prisma db pull
```

### Q2: æ—§ä»»åŠ¡æ²¡æœ‰é¢œè‰²å’Œè¿›åº¦ï¼Ÿ

è¿™æ˜¯æ­£å¸¸çš„ï¼æ–°å¢å­—æ®µä¸ºå¯é€‰ï¼š

- `color`: é»˜è®¤ä¸º `null`ï¼Œæ—§ä»»åŠ¡ä½¿ç”¨é»˜è®¤è“è‰²
- `progress`: é»˜è®¤ä¸º `0`

ç”¨æˆ·å¯ä»¥ç¼–è¾‘æ—§ä»»åŠ¡æ¥è®¾ç½®é¢œè‰²å’Œè¿›åº¦ã€‚

### Q3: HTTP/IP åŸŸåä¸‹å¤åˆ¶åŠŸèƒ½ä¸å·¥ä½œï¼Ÿ

å·²å®ç°é™çº§æ–¹æ¡ˆï¼š

1. ä¼˜å…ˆä½¿ç”¨ `navigator.clipboard` (HTTPS)
2. é™çº§ä½¿ç”¨ `document.execCommand` (HTTP/IP)
3. å¦‚æœä»å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œç”¨æˆ·å¯æ‰‹åŠ¨å¤åˆ¶

### Q4: å‘¨è§†å›¾æ ·å¼ä¸ä¸€è‡´ï¼Ÿ

ç¡®ä¿å·²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚æœ¬æ¬¡æ›´æ–°ç»Ÿä¸€äº†æ‰€æœ‰è§†å›¾ä½¿ç”¨ `TaskBar` ç»„ä»¶ã€‚

---

## ğŸ“ åç»­ç»´æŠ¤

### å®šæœŸæ£€æŸ¥

```bash
# æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡å®¹å™¨çŠ¶æ€
docker-compose ps

# æ¯æœˆæ£€æŸ¥ä¸€æ¬¡æ—¥å¿—å¤§å°
du -sh /var/lib/docker/containers/*

# æ¸…ç†æ—§é•œåƒ
docker image prune -a
```

### æ•°æ®å¤‡ä»½

```bash
# å¤‡ä»½æ•°æ®åº“ï¼ˆå»ºè®®æ¯å¤©æ‰§è¡Œï¼‰
docker exec calendar-postgres pg_dump -U postgres calendar_tasks > \
  backup_$(date +%Y%m%d).sql

# ä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
find . -name "backup_*.sql" -mtime +30 -delete
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**: `docker-compose logs -f`
2. **æ£€æŸ¥è¿ç§»çŠ¶æ€**: `docker exec calendar-app npx prisma migrate status`
3. **æ•°æ®åº“è¿æ¥æµ‹è¯•**: `docker exec -it calendar-postgres psql -U postgres`
4. **GitHub Issues**: [æäº¤é—®é¢˜](https://github.com/tutusiji/calendar-task-manager/issues)

---

## âœ¨ éƒ¨ç½²å®Œæˆ

æ­å–œï¼ä»»åŠ¡é¢œè‰²ä¸è¿›åº¦åŠŸèƒ½å·²æˆåŠŸéƒ¨ç½²ã€‚

**ä¸‹æ¬¡æ›´æ–°**: æ¨é€ä»£ç åˆ° GitHub main åˆ†æ”¯å³å¯è‡ªåŠ¨éƒ¨ç½²ã€‚
